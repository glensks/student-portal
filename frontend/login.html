<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Information System - Portal</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Crimson+Pro:wght@600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/login.css">

</head>
<body>

<!-- ======================== FORGOT PASSWORD MODAL ======================== -->
<div class="modal-overlay" id="forgotModal" onclick="closeForgotModalOnOverlay(event)">
    <div class="modal">
        <button class="modal-close" onclick="closeForgotModal()" title="Close">‚úï</button>
        <div style="text-align:center;">
            <div class="modal-icon">üîë</div>
            <h2 class="modal-title">Forgot Password</h2>
            <p class="modal-subtitle" id="modalSubtitle">Enter your registered email address and we'll send you a link to reset your password.</p>
        </div>
        <!-- Step 1: Email input -->
        <div class="modal-step active" id="modalStep1">
            <div class="form-group" style="margin-bottom:20px;">
                <label class="form-label" for="forgot_email">Email Address <span class="required-mark">*</span></label>
                <input type="email" id="forgot_email" class="form-control" placeholder="your.email@example.com" autocomplete="email">
                <span class="field-error" id="forgotEmailErr"></span>
            </div>
            <button class="btn btn-primary btn-block" onclick="submitForgotPassword()" id="forgotBtn">Send Reset Link</button>
            <div id="forgotMsg" class="message-box" style="margin-top:16px;"></div>
        </div>
        <!-- Step 2: Success screen -->
        <div class="modal-step" id="modalStep2">
            <div style="text-align:center;padding:16px 0;">
                <div style="font-size:48px;margin-bottom:16px;">üì¨</div>
                <p style="color:var(--neutral-700);font-size:15px;line-height:1.7;margin-bottom:20px;">
                    We've sent a password reset link to <strong id="sentToEmail"></strong>.<br>
                    Check your inbox and follow the instructions.
                </p>
                <p style="color:var(--neutral-500);font-size:13px;margin-bottom:20px;">
                    Didn't receive it? Check your spam folder, or
                    <button class="btn-link" onclick="resendReset()" style="font-size:13px;">resend the email</button>.
                </p>
                <button class="btn btn-primary btn-block" onclick="closeForgotModal()">Back to Login</button>
            </div>
        </div>
    </div>
</div>

<!-- ======================== HEADER ======================== -->
<header class="portal-header">
    <div class="header-top">
        <div class="header-top-content">
            <div class="header-links">
                <a href="#">University Website</a>
                <a href="#">Library</a>
                <a href="#">Support</a>
            </div>
            <div class="header-date" id="currentDate"></div>
        </div>
    </div>
    <div class="header-main">
        <div class="university-brand">
            <div class="university-seal">üéì</div>
            <div class="university-info">
                <h1>Student Information System</h1>
                <p>Academic Portal</p>
            </div>
        </div>
        <div class="header-actions">
            <a href="#" class="help-link">Need Help?</a>
        </div>
    </div>
</header>

<!-- ======================== MAIN ======================== -->
<main>

    <!-- ====== RESET PASSWORD PAGE ====== -->
    <div class="reset-page" id="resetPage">
        <div class="reset-card">
            <div style="text-align:center;">
                <div class="reset-icon">üîí</div>
                <h2 class="reset-title">Create New Password</h2>
                <p class="reset-subtitle">Enter your new password below. Make sure it's strong and memorable.</p>
            </div>
            <div id="resetFormArea">
                <div class="form-group" style="margin-bottom:20px;">
                    <label class="form-label" for="new_password">New Password <span class="required-mark">*</span></label>
                    <div class="input-wrap">
                        <input type="password" id="new_password" class="form-control" placeholder="Minimum 8 characters" oninput="checkPasswordStrength()">
                        <button type="button" class="toggle-pw" onclick="togglePw('new_password', this)" tabindex="-1">
                            <svg class="eye-show" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                            <svg class="eye-hide" style="display:none" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                        </button>
                    </div>
                    <div class="password-strength" id="strengthIndicator" style="display:none;">
                        <div class="strength-bar"><div class="strength-fill" id="strengthFill"></div></div>
                        <div class="strength-label" id="strengthLabel"></div>
                    </div>
                </div>
                <div class="form-group" style="margin-bottom:24px;">
                    <label class="form-label" for="confirm_password">Confirm Password <span class="required-mark">*</span></label>
                    <div class="input-wrap">
                        <input type="password" id="confirm_password" class="form-control" placeholder="Re-enter your new password" oninput="checkPasswordMatch()">
                        <button type="button" class="toggle-pw" onclick="togglePw('confirm_password', this)" tabindex="-1">
                            <svg class="eye-show" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                            <svg class="eye-hide" style="display:none" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                        </button>
                    </div>
                    <div id="matchMsg" style="font-size:13px;margin-top:6px;"></div>
                </div>
                <button class="btn btn-primary btn-block" onclick="submitResetPassword()" id="resetBtn">Reset Password</button>
                <div id="resetMsg" class="message-box" style="margin-top:16px;"></div>
            </div>
            <div id="resetSuccess" style="display:none;text-align:center;padding:16px 0;">
                <div style="font-size:48px;margin-bottom:16px;">‚úÖ</div>
                <p style="color:var(--neutral-700);font-size:15px;line-height:1.7;margin-bottom:20px;">Your password has been reset successfully!</p>
                <a href="/" class="btn btn-primary btn-block">Go to Login</a>
            </div>
            <div id="invalidToken" style="display:none;text-align:center;padding:16px 0;">
                <div style="font-size:48px;margin-bottom:16px;">‚õî</div>
                <p style="font-weight:600;color:var(--forest-900);margin-bottom:8px;">Link Expired or Invalid</p>
                <p style="color:var(--neutral-600);font-size:14px;margin-bottom:20px;">This password reset link is no longer valid. Links expire after 1 hour.</p>
                <button class="btn btn-primary btn-block" onclick="openForgotModal()">Request a New Link</button>
            </div>
        </div>
    </div>

    <!-- ====== NORMAL PORTAL ====== -->
    <div class="main-container" id="portalContainer">
        <div class="breadcrumb"><a href="#">Home</a> / Student Portal</div>

        <nav class="portal-nav">
            <button class="nav-tab active" onclick="switchTab('login')">Student Login</button>
            <button class="nav-tab" onclick="switchTab('register')">New Student Registration</button>
        </nav>

        <div class="portal-content">

            <!-- ======== LOGIN SECTION ======== -->
            <section id="loginSection" class="content-section active">
                <div class="login-container">
                    <div class="alert-box">
                        <div class="alert-icon">‚ÑπÔ∏è</div>
                        <div class="alert-content">
                            <div class="alert-title">Welcome to the Student Portal</div>
                            <div class="alert-text">Please enter your credentials to access your account. If you're a new student, please use the registration tab.</div>
                        </div>
                    </div>
                    <div class="login-card">
                        <div class="login-header">
                            <div class="login-icon">üë§</div>
                            <h2 class="login-title">Student Login</h2>
                            <p class="login-subtitle">Access your academic records and information</p>
                        </div>
                        <form onsubmit="return false;">
                            <div class="form-group">
                                <label class="form-label" for="login_id">Student ID Number <span class="required-mark">*</span></label>
                                <input type="text" id="login_id" class="form-control" placeholder="Enter your student ID (e.g., 2024-00001)" autocomplete="username" maxlength="20">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Digits and hyphens only ‚Äî format: YYYY-NNNNN</div>
                            </div>
                            <div class="form-group" style="margin-bottom:4px;">
                                <label class="form-label" for="login_password">Password <span class="required-mark">*</span></label>
                                <div class="input-wrap">
                                    <input type="password" id="login_password" class="form-control" placeholder="Enter your password" autocomplete="current-password">
                                    <button type="button" class="toggle-pw" onclick="togglePw('login_password', this)" tabindex="-1">
                                        <svg class="eye-show" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                                        <svg class="eye-hide" style="display:none" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                                    </button>
                                </div>
                            </div>
                            <div class="forgot-password-row">
                                <button class="btn-link" type="button" onclick="openForgotModal()">Forgot Password?</button>
                            </div>
                            <button type="submit" class="btn btn-primary btn-block" onclick="login()">Sign In</button>
                            <div id="loginMsg" class="message-box"></div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- ======== REGISTRATION SECTION ======== -->
            <section id="registerSection" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">New Student Registration</h2>
                    <p class="section-description">Please complete all required fields to submit your application.</p>
                </div>
                <div class="alert-box">
                    <div class="alert-icon">üìã</div>
                    <div class="alert-content">
                        <div class="alert-title">Application Guidelines</div>
                        <div class="alert-text">All fields marked with <span class="required-mark">*</span> are required. Please ensure all information is accurate before submission.</div>
                    </div>
                </div>
                <div class="progress-indicator" id="progressIndicator" style="display:none;">
                    <div class="progress-label">
                        <span>Application Progress</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
                </div>

                <form onsubmit="return false;">

                    <!-- Personal Info -->
                    <div class="form-card">
                        <div class="form-card-header">
                            <div class="form-card-icon">üë§</div>
                            <h3 class="form-card-title">Personal Information</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label" for="student_id">Student ID Number <span class="required-mark">*</span></label>
                                <input type="text" id="student_id" class="form-control" placeholder="e.g., 2024-00001" maxlength="20" oninput="updateProgress()">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Digits and hyphens only (YYYY-NNNNN)</div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="password">Password <span class="required-mark">*</span></label>
                                <div class="input-wrap">
                                    <input type="password" id="password" class="form-control" placeholder="Create a secure password (min 8 chars)" oninput="updateProgress()">
                                    <button type="button" class="toggle-pw" onclick="togglePw('password', this)" tabindex="-1">
                                        <svg class="eye-show" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                                        <svg class="eye-hide" style="display:none" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label" for="first_name">First Name <span class="required-mark">*</span></label>
                                <input type="text" id="first_name" class="form-control" placeholder="First name" maxlength="50" oninput="updateProgress()">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Letters only, no numbers or special characters</div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="middle_name">Middle Name</label>
                                <input type="text" id="middle_name" class="form-control" placeholder="Middle name (optional)" maxlength="50">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Letters only</div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="last_name">Last Name <span class="required-mark">*</span></label>
                                <input type="text" id="last_name" class="form-control" placeholder="Last name" maxlength="50" oninput="updateProgress()">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Letters only, no numbers or special characters</div>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label" for="age">Age <span class="required-mark">*</span></label>
                                <input type="text" id="age" class="form-control" placeholder="Age (15‚Äì100)" maxlength="3" oninput="updateProgress()">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Numbers only (15‚Äì100)</div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="contact_number">Contact Number <span class="required-mark">*</span></label>
                                <input type="text" id="contact_number" class="form-control" placeholder="09XX XXX XXXX" maxlength="15" oninput="updateProgress()">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Digits only, no letters or special characters</div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="email">Email Address <span class="required-mark">*</span></label>
                                <input type="email" id="email" class="form-control" placeholder="student@email.com" maxlength="100" oninput="updateProgress()">
                                <span class="field-error"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="address">Complete Address <span class="required-mark">*</span></label>
                            <textarea id="address" class="form-control" placeholder="House/Unit No., Street, Barangay, City/Municipality, Province" maxlength="200" oninput="updateProgress()"></textarea>
                            <span class="field-error"></span>
                        </div>
                    </div>

                    <!-- Father's Info -->
                    <div class="form-card">
                        <div class="form-card-header">
                            <div class="form-card-icon">üë®</div>
                            <h3 class="form-card-title">Father's Information</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">First Name</label>
                                <input type="text" id="father_first_name" class="form-control" placeholder="First name" maxlength="50">
                                <span class="field-error"></span>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Middle Name</label>
                                <input type="text" id="father_middle_name" class="form-control" placeholder="Middle name" maxlength="50">
                                <span class="field-error"></span>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last Name</label>
                                <input type="text" id="father_last_name" class="form-control" placeholder="Last name" maxlength="50">
                                <span class="field-error"></span>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Occupation</label>
                                <input type="text" id="father_occupation" class="form-control" placeholder="Occupation" maxlength="100">
                                <span class="field-error"></span>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Contact Number</label>
                                <input type="text" id="father_contact_number" class="form-control" placeholder="Contact number" maxlength="15">
                                <span class="field-error"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Address</label>
                            <textarea id="father_address" class="form-control" placeholder="Complete address" maxlength="200"></textarea>
                        </div>
                    </div>

                    <!-- Mother's Info -->
                    <div class="form-card">
                        <div class="form-card-header">
                            <div class="form-card-icon">üë©</div>
                            <h3 class="form-card-title">Mother's Information</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">First Name</label>
                                <input type="text" id="mother_first_name" class="form-control" placeholder="First name" maxlength="50">
                                <span class="field-error"></span>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Middle Name</label>
                                <input type="text" id="mother_middle_name" class="form-control" placeholder="Middle name" maxlength="50">
                                <span class="field-error"></span>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last Name</label>
                                <input type="text" id="mother_last_name" class="form-control" placeholder="Last name" maxlength="50">
                                <span class="field-error"></span>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Occupation</label>
                                <input type="text" id="mother_occupation" class="form-control" placeholder="Occupation" maxlength="100">
                                <span class="field-error"></span>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Contact Number</label>
                                <input type="text" id="mother_contact_number" class="form-control" placeholder="Contact number" maxlength="15">
                                <span class="field-error"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Address</label>
                            <textarea id="mother_address" class="form-control" placeholder="Complete address" maxlength="200"></textarea>
                        </div>
                    </div>

                    <!-- Academic Info -->
                    <div class="form-card">
                        <div class="form-card-header">
                            <div class="form-card-icon">üéì</div>
                            <h3 class="form-card-title">Academic Information</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label" for="last_school_attended">Last School Attended <span class="required-mark">*</span></label>
                                <input type="text" id="last_school_attended" class="form-control" placeholder="Name of previous school" maxlength="100" oninput="updateProgress()">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Letters and basic punctuation only</div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="last_school_year">School Year <span class="required-mark">*</span></label>
                                <input type="text" id="last_school_year" class="form-control" placeholder="e.g., 2022-2023" maxlength="9" oninput="updateProgress()">
                                <span class="field-error"></span>
                                <div class="form-hint">üí° Format: YYYY-YYYY (digits and hyphen only)</div>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label" for="course">Course/Program <span class="required-mark">*</span></label>
                                <select id="course" class="form-control" onchange="updateProgress()">
                                    <option value="">Select a course</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="year_level">Year Level <span class="required-mark">*</span></label>
                                <select id="year_level" class="form-control" onchange="updateProgress()">
                                    <option value="">Select year level</option>
                                    <option value="1">First Year</option>
                                    <option value="2">Second Year</option>
                                    <option value="3">Third Year</option>
                                    <option value="4">Fourth Year</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="scholarship_status">Scholarship Status <span class="required-mark">*</span></label>
                            <select id="scholarship_status" class="form-control" onchange="updateProgress()">
                                <option value="">Select scholarship status</option>
                                <option value="scholar">Scholar</option>
                                <option value="non-scholar">Non-Scholar</option>
                            </select>
                            <div class="form-hint">üí° Select if you are a scholar or non-scholar student.</div>
                        </div>
                        <div class="form-group" style="margin-bottom:20px;">
                            <label class="form-label" for="semester">Semester <span class="required-mark">*</span></label>
                            <select id="semester" class="form-control" onchange="updateProgress()">
                                <option value="">Select semester</option>
                                <option value="1st">1st Semester</option>
                                <option value="2nd">2nd Semester</option>
                                <option value="summer">Summer</option>
                            </select>
                            <div class="form-hint">üìÖ Subjects below will update based on your selected semester.</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="subjects">Select Subjects <span class="required-mark">*</span></label>
                            <div id="subjectsPrompt" class="subjects-prompt">
                                <div class="prompt-icon">üìö</div>
                                <div>Please select your <strong>Course</strong>, <strong>Year Level</strong>, and <strong>Semester</strong> first to load available subjects.</div>
                            </div>
                            <select id="subjects" class="form-control" multiple onchange="updateSelectedSubjects()" style="display:none;"></select>
                            <div class="form-hint">üí° Click to select/deselect. You can choose multiple subjects.</div>
                            <div id="selectedSubjectsDisplay" class="selected-subjects">
                                <div class="selected-subjects-title">Selected Subjects (<span id="selectedCount">0</span>):</div>
                                <div class="selected-subjects-list" id="selectedSubjectsList"></div>
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block" onclick="register()">Submit Application</button>
                    <div id="registerMsg" class="message-box"></div>
                </form>
            </section>

        </div>
    </div>
</main>

<footer class="portal-footer">
    <div class="footer-links">
        <a href="#">Privacy Policy</a>
        <a href="#">Terms of Service</a>
        <a href="#">Contact Support</a>
        <a href="#">Help Center</a>
    </div>
    <p>&copy; 2024 University Student Information System. All rights reserved.</p>
</footer>

<script src="js/login.js"></script>
</body>
</html>